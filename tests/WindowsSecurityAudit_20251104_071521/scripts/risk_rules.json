{
  "riskRules": [
    {
      "category": "Antivirus",
      "file": "04_antivirus_defender.txt",
      "checks": [
        {
          "name": "Defender Disabled",
          "pattern": "AntivirusEnabled\\s*:\\s*False",
          "severity": "Critical",
          "points": -8,
          "description": "Windows Defender antivirus is disabled"
        },
        {
          "name": "Real-Time Protection Off",
          "pattern": "RealTimeProtectionEnabled\\s*:\\s*False",
          "severity": "High",
          "points": -5,
          "description": "Real-time protection is turned off"
        },
        {
          "name": "No Antivirus",
          "pattern": "No antivirus|not available",
          "severity": "Critical",
          "points": -10,
          "description": "No antivirus software detected"
        }
      ]
    },
    {
      "category": "Firewall",
      "file": "05_firewall.txt",
      "checks": [
        {
          "name": "Firewall Disabled",
          "pattern": "Enabled\\s*:\\s*False",
          "severity": "Critical",
          "points": -7,
          "description": "Windows Firewall is disabled"
        },
        {
          "name": "Inbound Allow All",
          "pattern": "DefaultInboundAction\\s*:\\s*Allow",
          "severity": "High",
          "points": -5,
          "description": "Firewall allows all inbound connections by default"
        }
      ]
    },
    {
      "category": "Updates",
      "file": "02_installed_updates.txt",
      "checks": [
        {
          "name": "No Recent Updates",
          "pattern": "^\\s*$",
          "severity": "Medium",
          "points": -3,
          "description": "No Windows updates found or updates outdated"
        }
      ]
    },
    {
      "category": "Remote Desktop",
      "file": "10_rdp.txt",
      "checks": [
        {
          "name": "RDP Enabled",
          "pattern": "RDP enabled.*fDenyTSConnections=0",
          "severity": "Medium",
          "points": -2,
          "description": "Remote Desktop is enabled (potential attack vector)"
        },
        {
          "name": "NLA Disabled",
          "pattern": "UserAuthentication\\s*:\\s*0",
          "severity": "High",
          "points": -5,
          "description": "Network Level Authentication is disabled for RDP"
        }
      ]
    },
    {
      "category": "SMB",
      "file": "11_smb.txt",
      "checks": [
        {
          "name": "SMBv1 Enabled",
          "pattern": "EnableSMB1Protocol\\s*:\\s*True",
          "severity": "High",
          "points": -5,
          "description": "Insecure SMBv1 protocol is enabled"
        },
        {
          "name": "Unencrypted SMB",
          "pattern": "EncryptData\\s*:\\s*False",
          "severity": "Medium",
          "points": -3,
          "description": "SMB encryption is not enabled"
        }
      ]
    },
    {
      "category": "BitLocker",
      "file": "12_bitlocker.txt",
      "checks": [
        {
          "name": "Disk Not Encrypted",
          "pattern": "VolumeStatus\\s*:\\s*FullyDecrypted",
          "severity": "Medium",
          "points": -3,
          "description": "System drive is not encrypted with BitLocker"
        }
      ]
    },
    {
      "category": "Password Policy",
      "file": "09_password_policy.txt",
      "checks": [
        {
          "name": "Weak Password Length",
          "pattern": "Minimum password length\\s*:\\s*[0-7]",
          "severity": "High",
          "points": -5,
          "description": "Minimum password length is too short (less than 8 characters)"
        },
        {
          "name": "No Password Expiry",
          "pattern": "Maximum password age.*Unlimited",
          "severity": "Medium",
          "points": -3,
          "description": "Passwords never expire"
        }
      ]
    },
    {
      "category": "User Accounts",
      "file": "08_users_admins.txt",
      "checks": [
        {
          "name": "Guest Account Enabled",
          "pattern": "Guest.*Enabled\\s*:\\s*True",
          "severity": "High",
          "points": -5,
          "description": "Guest account is enabled"
        },
        {
          "name": "Password Never Expires",
          "pattern": "PasswordExpires\\s*:\\s*Never",
          "severity": "Medium",
          "points": -2,
          "description": "User account has password that never expires"
        }
      ]
    },
    {
      "category": "System Integrity",
      "file": "20_sfc_scannow.txt",
      "checks": [
        {
          "name": "File Corruption Detected",
          "pattern": "found corrupt files|integrity violations",
          "severity": "High",
          "points": -6,
          "description": "System file corruption detected"
        }
      ]
    },
    {
      "category": "Services",
      "file": "07_services.txt",
      "checks": [
        {
          "name": "Critical Service Stopped",
          "pattern": "Windows Defender.*Stopped|Windows Update.*Stopped",
          "severity": "High",
          "points": -5,
          "description": "Critical security service is not running"
        }
      ]
    }
  ],
  "scoreCategories": {
    "excellent": { "min": 90, "max": 100, "label": "Excellent", "color": "#d4edda" },
    "good": { "min": 75, "max": 89, "label": "Good", "color": "#d1ecf1" },
    "fair": { "min": 60, "max": 74, "label": "Fair", "color": "#fff3cd" },
    "poor": { "min": 40, "max": 59, "label": "Poor", "color": "#f8d7da" },
    "critical": { "min": 0, "max": 39, "label": "Critical", "color": "#f5c6cb" }
  }
}
